
<div class="container-fluid w-75">
  <h3 class="mt-5 mb-3 mx-auto">
    Search Results for {{capitalize searchName}}: {{searchResult.length}}
  </h3>
  {{#if searchResult}}
    <div class="row no-gutters justify-content-between">
      {{#each searchResult}}
        <div class=" col-auto mb-4 ml-2">
          <div class="card" style="width: 24rem; min-width:24rem">
            <img src="#" class="card-img-top" alt="..." />
            <div class="card-body">
              <h4 class="card-title">
                <span>
                  {{itemName}}
                </span>
              </h4>
              <h5>
                <span>
                  Price:
                  ${{distanceFixed itemPrice}}
                </span>
              </h5>
              <p class="card-text">
                <span>
                  {{itemDescription}}
                </span>
              </p>
              <p class="text-muted">
                <span>
                  {{itemCity}}, 
                  {{itemState}}
                  {{itemZip}}
                  ({{distanceFixed distanceFromSearch}}
                  Mi)
                </span>
              </p>
            </div>
          </div>
        </div>
      {{else}}
        <h3>
          No items
        </h3>
      {{/each}}
    </div>
  {{/if}}
   {{#if searchResult}}
     <div id="mapid"></div>
  {{/if}}
</div>  
</div>


<script>
  
    var moon = "{{{searchResult}}}"
    var data = "{{json searchResult}}"
    data = data.replace(/(&quot\;)/g,"\"")
    console.log(data)
    let dataArray = JSON.parse(data);
    console.log(dataArray)
    var map = L.map('mapid').setView([dataArray[0].itemLat, dataArray[0].itemLong], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

  dataArray.forEach(function(entry){
  var name = entry.itemName
  var address = entry.itemAddress + "\n" + entry.itemCity + "," + entry.itemState
  L.marker([entry.itemLat, entry.itemLong]).addTo(map) 
  .bindPopup(entry.itemName + '<br>' + address)
  .openPopup();
});


  
</script>
{{!-- "{{json searchResult}}" --}}
{{!-- <script src="/scripts/mapDisplay.js"></script> --}}

<script src="https://twitter.github.io/typeahead.js/js/handlebars.js"></script>
{{!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDbpFSCCO6QuYnyX0FiOkAqE110PV6k1d4&callback=initMap" async defer></script> --}}
 